# 05. Калибровка и Метрики Earth-like Качества

## 1. Зачем нужны метрики

Оценка "нравится/не нравится" глазами недостаточна.  
Нужен автоматический scoring, чтобы:

1. Отлавливать регрессии.
2. Ранжировать сиды.
3. Понимать, что реально улучшилось после правок.

## 2. Набор основных метрик

### 2.1 Hypsometry (высоты суши и глубины океана)

Проверяем:

1. Бимодальность глобального распределения (суша/океан).
2. Реалистичный хвост высоких гор.
3. Реалистичный хвост глубоководных областей.

### 2.2 Orogen Width Distribution

Для зон высокой деформации:

1. Считаем ширину орогена поперек простирания.
2. Требуем широкий диапазон, а не один постоянный размер.

### 2.3 Ridge Linearity Penalty

Штраф за "идеальные линии":

1. Детектируем слишком длинные прямые гребни без сегментации.
2. Штраф усиливается при одинаковой толщине линии на большой длине.

### 2.4 Coastline Complexity

1. Фрактальная размерность береговой линии.
2. Распределение размеров островов и заливов.
3. Баланс между "слишком гладко" и "шумовой рванью".

### 2.5 Bathymetry Realism

1. Контраст шельф/склон/абиссаль.
2. Разнообразие глубин.
3. Локализация траншей в правильных тектонических режимах.

### 2.6 Drainage Network Quality

1. Отсутствие циклов.
2. Древовидность сети.
3. Реалистичное распределение длин и порядков русел.

## 3. Интегральный скор

Пример:

`Score = w1*Hyps + w2*Orogen + w3*Bathy + w4*Coast + w5*Drain - w6*LinearityPenalty`

Где веса фиксируются в пресете `earth_like`.

## 4. Режимы отбора сидов

1. `quick` — быстрый просмотр (малая статистика).
2. `standard` — базовый отбор.
3. `deep` — большой перебор, дорогой по времени.

## 5. Минимальные thresholds для "приемки"

1. Линейный штраф ниже порога `L_max`.
2. Ширины орогенов: коэффициент вариации выше `CV_min`.
3. Доля океана и hypsometry в целевых диапазонах.
4. У батиметрии нет глобально одинакового прибрежного ореола.

## 6. Что сохранять по каждому прогону

1. `height_preview.jpg/png`
2. `score.json` (все метрики + итог).
3. Список параметров.
4. Сид и таймстамп.

Это нужно, чтобы сравнивать версии алгоритма объективно.

